<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Good Deeds â€” Noor</title>
  <meta property="og:title" content="Good Deeds Tracker âœ… â€” Noor">
  <meta property="og:description" content="Track your daily good deeds this Ramadan. Small acts, big rewards.">
  <meta property="og:image" content="https://raw.githubusercontent.com/aboladelawal/noor/main/og-noor.png">
  <meta property="og:url" content="https://noor-seven-lac.vercel.app/deeds">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=Tajawal:wght@300;400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0a0a0f; --gold: #c9a84c; --gold-light: #e8c97a;
      --gold-dim: #7a6130; --cream: #f5efe0; --text: #e8dcc8; --text-dim: #8a7d6a;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { background: var(--bg); color: var(--text); font-family: 'Tajawal', sans-serif; min-height: 100vh; overflow-x: hidden; padding-bottom: 60px; }
    body::before {
      content: ''; position: fixed; inset: 0; pointer-events: none; z-index: 0;
      background-image:
        radial-gradient(1px 1px at 20% 15%, rgba(201,168,76,0.5) 0%, transparent 100%),
        radial-gradient(1px 1px at 80% 25%, rgba(201,168,76,0.3) 0%, transparent 100%),
        radial-gradient(1px 1px at 50% 70%, rgba(201,168,76,0.4) 0%, transparent 100%),
        radial-gradient(1px 1px at 75% 85%, rgba(201,168,76,0.3) 0%, transparent 100%),
        radial-gradient(1.5px 1.5px at 10% 55%, rgba(201,168,76,0.4) 0%, transparent 100%);
    }
    .page { position: relative; z-index: 1; max-width: 480px; margin: 0 auto; padding: 24px 20px; }
    .back { display: inline-flex; align-items: center; gap: 8px; color: var(--text-dim); text-decoration: none; font-size: 13px; margin-bottom: 32px; transition: color 0.2s; }
    .back:hover { color: var(--gold); }

    .header { text-align: center; margin-bottom: 32px; }
    .header-icon { font-size: 48px; margin-bottom: 10px; display: block; }
    .header h1 { font-family: 'Cormorant Garamond', serif; font-size: 42px; font-weight: 300; color: var(--gold-light); line-height: 1; }
    .header p { font-size: 13px; color: var(--text-dim); margin-top: 10px; line-height: 1.6; font-weight: 300; }

    /* Day badge */
    .day-badge { text-align: center; margin-bottom: 24px; }
    .day-badge span { display: inline-block; background: rgba(201,168,76,0.1); border: 1px solid rgba(201,168,76,0.2); border-radius: 20px; padding: 6px 16px; font-size: 12px; color: var(--gold); letter-spacing: 1px; }

    /* Score ring */
    .score-section { text-align: center; margin-bottom: 28px; }
    .score-ring { display: inline-flex; flex-direction: column; align-items: center; justify-content: center; width: 120px; height: 120px; border-radius: 50%; border: 2px solid rgba(201,168,76,0.2); background: rgba(201,168,76,0.05); position: relative; margin-bottom: 12px; }
    .score-ring::before { content: ''; position: absolute; inset: -3px; border-radius: 50%; background: conic-gradient(var(--gold) var(--pct, 0%), transparent 0%); z-index: -1; }
    .score-ring::after { content: ''; position: absolute; inset: 2px; border-radius: 50%; background: var(--bg); z-index: -1; }
    .score-num { font-family: 'Cormorant Garamond', serif; font-size: 42px; font-weight: 300; color: var(--gold-light); line-height: 1; }
    .score-denom { font-size: 11px; color: var(--text-dim); letter-spacing: 1px; }
    .score-label { font-size: 13px; color: var(--text-dim); }
    .streak-badge { display: inline-flex; align-items: center; gap: 6px; background: rgba(201,168,76,0.08); border: 1px solid rgba(201,168,76,0.15); border-radius: 16px; padding: 4px 12px; font-size: 12px; color: var(--gold-dim); margin-top: 6px; }

    /* Category sections */
    .category { margin-bottom: 24px; }
    .cat-label { font-size: 10px; letter-spacing: 3px; color: var(--gold-dim); text-transform: uppercase; margin-bottom: 12px; padding-left: 4px; }

    /* Deed grid */
    .deeds-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .deed-item {
      background: rgba(255,255,255,0.02);
      border: 1px solid rgba(201,168,76,0.12);
      border-radius: 14px;
      padding: 16px 14px;
      cursor: pointer;
      transition: all 0.25s ease;
      position: relative;
      overflow: hidden;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    .deed-item:hover { border-color: rgba(201,168,76,0.3); background: rgba(201,168,76,0.05); }
    .deed-item.done {
      background: rgba(201,168,76,0.12);
      border-color: rgba(201,168,76,0.4);
    }
    .deed-item.done::after {
      content: 'âœ“';
      position: absolute;
      top: 8px; right: 10px;
      font-size: 12px;
      color: var(--gold);
    }
    .deed-emoji { font-size: 24px; margin-bottom: 8px; display: block; transition: transform 0.2s; }
    .deed-item:active .deed-emoji { transform: scale(1.2); }
    .deed-name { font-size: 13px; color: var(--text); font-weight: 400; line-height: 1.3; }
    .deed-item.done .deed-name { color: var(--gold-light); }
    .deed-points { font-size: 10px; color: var(--gold-dim); margin-top: 4px; letter-spacing: 0.5px; }
    .deed-item.done .deed-points { color: var(--gold); }

    /* Completion message */
    .completion-msg {
      background: linear-gradient(135deg, rgba(201,168,76,0.12), rgba(201,168,76,0.05));
      border: 1px solid rgba(201,168,76,0.25);
      border-radius: 16px;
      padding: 24px;
      text-align: center;
      margin-bottom: 20px;
      display: none;
    }
    .completion-msg.show { display: block; }
    .completion-msg .big { font-size: 36px; margin-bottom: 10px; }
    .completion-msg h3 { font-family: 'Cormorant Garamond', serif; font-size: 24px; color: var(--gold-light); margin-bottom: 8px; }
    .completion-msg p { font-size: 13px; color: var(--text-dim); line-height: 1.6; }

    /* Hadith card */
    .hadith-card { background: rgba(255,255,255,0.02); border: 1px solid rgba(201,168,76,0.1); border-radius: 16px; padding: 20px; margin-bottom: 16px; }
    .hadith-label { font-size: 10px; letter-spacing: 2px; color: var(--gold-dim); text-transform: uppercase; margin-bottom: 10px; }
    .hadith-text { font-size: 14px; color: var(--text); line-height: 1.7; font-style: italic; }
    .hadith-source { font-size: 11px; color: var(--gold-dim); margin-top: 8px; }

    /* Calendar strip */
    .calendar-section { margin-top: 28px; }
    .calendar-label { font-size: 10px; letter-spacing: 3px; color: var(--gold-dim); text-transform: uppercase; margin-bottom: 12px; }
    .calendar-strip { display: flex; gap: 6px; overflow-x: auto; padding-bottom: 8px; }
    .calendar-strip::-webkit-scrollbar { height: 2px; }
    .calendar-strip::-webkit-scrollbar-track { background: transparent; }
    .calendar-strip::-webkit-scrollbar-thumb { background: var(--gold-dim); border-radius: 2px; }
    .cal-day { min-width: 36px; height: 44px; border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 11px; border: 1px solid rgba(201,168,76,0.1); flex-shrink: 0; gap: 2px; }
    .cal-day.past-empty { background: rgba(255,255,255,0.02); color: var(--text-dim); }
    .cal-day.has-deeds { background: rgba(201,168,76,0.12); border-color: rgba(201,168,76,0.3); color: var(--gold); }
    .cal-day.today { background: rgba(201,168,76,0.18); border-color: var(--gold); color: var(--gold-light); }
    .cal-day.future { opacity: 0.2; }
    .cal-num { font-weight: 600; font-size: 12px; }
    .cal-dot { width: 4px; height: 4px; border-radius: 50%; background: currentColor; }

    /* Toast */
    .toast { position: fixed; bottom: 32px; left: 50%; transform: translateX(-50%) translateY(100px); background: rgba(201,168,76,0.95); color: #0a0a0f; padding: 10px 20px; border-radius: 20px; font-size: 13px; font-weight: 500; transition: transform 0.3s ease; z-index: 200; white-space: nowrap; }
    .toast.show { transform: translateX(-50%) translateY(0); }
  </style>
</head>
<body>
  <div class="page">
    <a href="index.html" class="back">â† Back to Noor</a>

    <div class="header">
      <span class="header-icon">âœ…</span>
      <h1>Good Deeds</h1>
      <p>Tap what you've done today. Every small act is recorded.</p>
    </div>

    <div class="day-badge"><span id="day-badge-text">Ramadan Day 1 Â· 1447H</span></div>

    <!-- Score ring -->
    <div class="score-section">
      <div class="score-ring" id="score-ring">
        <span class="score-num" id="score-num">0</span>
        <span class="score-denom" id="score-denom">/ 0 done</span>
      </div>
      <div class="score-label" id="score-label">What have you done today?</div>
      <div class="streak-badge" id="streak-badge">ğŸ”¥ <span id="streak-num">0</span> day streak</div>
    </div>

    <!-- Completion message -->
    <div class="completion-msg" id="completion-msg">
      <div class="big">ğŸŒŸ</div>
      <h3>MashaAllah!</h3>
      <p>You've completed today's tracker. May Allah accept every deed and multiply its reward.</p>
    </div>

    <!-- Deeds by category -->
    <div id="deeds-container"></div>

    <!-- Hadith -->
    <div class="hadith-card" id="daily-hadith"></div>

    <!-- 30-day calendar -->
    <div class="calendar-section">
      <div class="calendar-label">Your Ramadan So Far</div>
      <div class="calendar-strip" id="calendar-strip"></div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // â”€â”€ Ramadan setup â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const RAMADAN_START = new Date('2026-02-18T00:00:00+01:00');
    function getRamadanDay() {
      return Math.max(1, Math.floor((new Date() - RAMADAN_START) / 86400000) + 1);
    }
    const TODAY_KEY = () => {
      const d = new Date();
      return `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}`;
    };

    // â”€â”€ Deed definitions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const CATEGORIES = [
      {
        label: 'Salah',
        deeds: [
          { id: 'fajr',     emoji: 'ğŸŒ…', name: 'Fajr on time',      pts: 'â˜…â˜…â˜…' },
          { id: 'dhuhr',    emoji: 'â˜€ï¸', name: 'Dhuhr on time',     pts: 'â˜…â˜…' },
          { id: 'asr',      emoji: 'ğŸŒ¤', name: 'Asr on time',       pts: 'â˜…â˜…' },
          { id: 'maghrib',  emoji: 'ğŸŒ‡', name: 'Maghrib on time',   pts: 'â˜…â˜…' },
          { id: 'isha',     emoji: 'ğŸŒ™', name: 'Isha on time',      pts: 'â˜…â˜…' },
          { id: 'tarawih',  emoji: 'ğŸ•Œ', name: 'Tarawih prayed',    pts: 'â˜…â˜…â˜…' },
        ]
      },
      {
        label: 'Quran',
        deeds: [
          { id: 'quran_page',  emoji: 'ğŸ“–', name: 'Read Quran',        pts: 'â˜…â˜…â˜…' },
          { id: 'quran_listen',emoji: 'ğŸ§', name: 'Listened to Quran', pts: 'â˜…â˜…' },
          { id: 'dhikr',       emoji: 'ğŸ“¿', name: 'Morning dhikr',     pts: 'â˜…â˜…' },
          { id: 'istighfar',   emoji: 'ğŸ¤²', name: 'Said Istighfar',    pts: 'â˜…â˜…' },
        ]
      },
      {
        label: 'Charity & Kindness',
        deeds: [
          { id: 'sadaqah',   emoji: 'ğŸ’›', name: 'Gave Sadaqah',         pts: 'â˜…â˜…â˜…' },
          { id: 'fed',       emoji: 'ğŸ½', name: 'Fed someone',          pts: 'â˜…â˜…â˜…' },
          { id: 'kind_word', emoji: 'ğŸ’¬', name: 'Said a kind word',     pts: 'â˜…â˜…' },
          { id: 'helped',    emoji: 'ğŸ¤', name: 'Helped someone',       pts: 'â˜…â˜…' },
        ]
      },
      {
        label: 'Self',
        deeds: [
          { id: 'suhoor',   emoji: 'ğŸŒ™', name: 'Had Suhoor',           pts: 'â˜…â˜…' },
          { id: 'iftar_dua',emoji: 'ğŸŒ…', name: 'Said Iftar dua',       pts: 'â˜…â˜…' },
          { id: 'lowered',  emoji: 'ğŸ‘', name: 'Lowered my gaze',      pts: 'â˜…â˜…' },
          { id: 'no_bad',   emoji: 'ğŸ¤', name: 'Avoided bad speech',   pts: 'â˜…â˜…' },
        ]
      },
    ];

    const HADITHS = [
      { text: "When Ramadan comes, the gates of Paradise are opened, the gates of Hell are closed, and the devils are chained.", source: "Sahih al-Bukhari 1899" },
      { text: "Whoever fasts Ramadan out of faith and in hope of reward, his previous sins will be forgiven.", source: "Sahih al-Bukhari 38" },
      { text: "There is in Paradise a gate called al-Rayyan, through which those who fasted will enter.", source: "Sahih al-Bukhari 1896" },
      { text: "The best charity is that given in Ramadan.", source: "Tirmidhi 663" },
      { text: "Every good deed of the son of Adam will be multiplied many times over... except fasting, for it is for Me and I will reward it.", source: "Sahih Muslim 1151" },
      { text: "Seek Laylatul Qadr in the odd-numbered nights of the last ten nights of Ramadan.", source: "Sahih al-Bukhari 2017" },
      { text: "The fasting person has two occasions for joy: when he breaks his fast he rejoices, and when he meets his Lord he will rejoice.", source: "Sahih Muslim 1151" },
    ];

    // â”€â”€ State â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function getTodayDeeds() {
      const raw = localStorage.getItem('noor_deeds_' + TODAY_KEY());
      return raw ? JSON.parse(raw) : {};
    }
    function saveTodayDeeds(done) {
      localStorage.setItem('noor_deeds_' + TODAY_KEY(), JSON.stringify(done));
    }
    function getAllDays() {
      const days = {};
      for (let i = 0; i < 30; i++) {
        const d   = new Date(RAMADAN_START);
        d.setDate(d.getDate() + i);
        const key = `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}`;
        const raw = localStorage.getItem('noor_deeds_' + key);
        days[i+1] = raw ? Object.keys(JSON.parse(raw)).length : 0;
      }
      return days;
    }
    function getStreak() {
      let streak = 0;
      const today = getRamadanDay();
      for (let i = today; i >= 1; i--) {
        const d   = new Date(RAMADAN_START);
        d.setDate(d.getDate() + i - 1);
        const key = `${d.getFullYear()}-${d.getMonth()}-${d.getDate()}`;
        const raw = localStorage.getItem('noor_deeds_' + key);
        if (raw && Object.keys(JSON.parse(raw)).length > 0) streak++;
        else break;
      }
      return streak;
    }

    // â”€â”€ Render â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    const ramadanDay = getRamadanDay();
    document.getElementById('day-badge-text').textContent = `Ramadan Day ${ramadanDay} Â· 1447H`;

    // Hadith
    const hadith = HADITHS[(ramadanDay - 1) % HADITHS.length];
    document.getElementById('daily-hadith').innerHTML = `
      <div class="hadith-label">Hadith of the Day</div>
      <div class="hadith-text">"${hadith.text}"</div>
      <div class="hadith-source">â€” ${hadith.source}</div>
    `;

    let done = getTodayDeeds();
    const totalDeeds = CATEGORIES.reduce((s, c) => s + c.deeds.length, 0);

    function updateScore() {
      done = getTodayDeeds();
      const count = Object.values(done).filter(Boolean).length;
      const pct   = Math.round((count / totalDeeds) * 100);

      document.getElementById('score-num').textContent = count;
      document.getElementById('score-denom').textContent = `/ ${totalDeeds} done`;
      document.getElementById('score-ring').style.setProperty('--pct', pct + '%');

      const labels = [
        [0,  'What have you done today?'],
        [3,  'A good start â€” keep going'],
        [8,  'MashaAllah, you\'re doing well'],
        [14, 'SubhanAllah â€” almost there!'],
        [totalDeeds, 'MashaAllah! Full day! ğŸŒŸ'],
      ];
      const label = [...labels].reverse().find(([n]) => count >= n);
      document.getElementById('score-label').textContent = label[1];

      document.getElementById('streak-num').textContent = getStreak();

      if (count === totalDeeds) {
        document.getElementById('completion-msg').classList.add('show');
      }
    }

    function renderDeeds() {
      const container = document.getElementById('deeds-container');
      container.innerHTML = CATEGORIES.map(cat => `
        <div class="category">
          <div class="cat-label">${cat.label}</div>
          <div class="deeds-grid">
            ${cat.deeds.map(d => `
              <div class="deed-item ${done[d.id] ? 'done' : ''}" onclick="toggleDeed('${d.id}', this)">
                <span class="deed-emoji">${d.emoji}</span>
                <div class="deed-name">${d.name}</div>
                <div class="deed-points">${d.pts}</div>
              </div>
            `).join('')}
          </div>
        </div>
      `).join('');
    }

    function toggleDeed(id, el) {
      done = getTodayDeeds();
      const wasD = done[id];
      if (wasD) {
        delete done[id];
        el.classList.remove('done');
      } else {
        done[id] = true;
        el.classList.add('done');
        showToast(wasD ? '' : getToastMsg());
      }
      saveTodayDeeds(done);
      updateScore();
      renderCalendar();
    }

    const TOASTS = [
      'Recorded âœ“ â€” Allah sees every good deed',
      'BaarakAllahu feekum ğŸŒ™',
      'SubhanAllah â€” keep going',
      'Allahu Akbar â€” every deed counts',
      'Recorded âœ“ â€” May Allah multiply your reward',
    ];
    let toastIdx = 0;
    function getToastMsg() { return TOASTS[toastIdx++ % TOASTS.length]; }

    function showToast(msg) {
      if (!msg) return;
      const t = document.getElementById('toast');
      t.textContent = msg;
      t.classList.add('show');
      setTimeout(() => t.classList.remove('show'), 2500);
    }

    // Calendar strip
    function renderCalendar() {
      const allDays = getAllDays();
      const today   = getRamadanDay();
      const strip   = document.getElementById('calendar-strip');
      strip.innerHTML = Array.from({length: 30}, (_, i) => {
        const day    = i + 1;
        const count  = allDays[day] || 0;
        const isPast = day < today;
        const isTod  = day === today;
        const isFut  = day > today;
        let cls = isTod ? 'today' : isPast ? (count > 0 ? 'has-deeds' : 'past-empty') : 'future';
        return `<div class="cal-day ${cls}">
          <span class="cal-num">${day}</span>
          ${(isTod || (isPast && count > 0)) ? '<span class="cal-dot"></span>' : ''}
        </div>`;
      }).join('');
      // Scroll to today
      const todayEl = strip.children[today - 1];
      if (todayEl) todayEl.scrollIntoView({ inline: 'center', behavior: 'smooth' });
    }

    // â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    renderDeeds();
    updateScore();
    renderCalendar();
  </script>
</body>
</html>
